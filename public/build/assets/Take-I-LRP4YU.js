import{j as e}from"./app-Nug6AceN.js";import{r as s,A as Q,S as O}from"./inertia-BH-W5z_F.js";import{u as I,a as z,b as V,c as W}from"./index-irFkzPAt.js";import{F as q}from"./ClockIcon-BS-c7_29.js";import{F as $}from"./ExclamationTriangleIcon-C4rf1al9.js";import{F as P}from"./ChevronLeftIcon-CY-C1SHW.js";import{F as H}from"./ChevronRightIcon-CsONSXmh.js";import{F as U}from"./XMarkIcon-DRZff1gW.js";import"./vendor-B3w1EZq-.js";function Z({title:a,titleId:r,...i},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},i),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const G=s.forwardRef(Z);function K({title:a,titleId:r,...i},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},i),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"}))}const Y=s.forwardRef(K);function J({title:a,titleId:r,...i},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},i),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"}))}const X=s.forwardRef(J);function ee({title:a,titleId:r,...i},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},i),a?s.createElement("title",{id:r},a):null,s.createElement("path",{fillRule:"evenodd",d:"M3 2.25a.75.75 0 0 1 .75.75v.54l1.838-.46a9.75 9.75 0 0 1 6.725.738l.108.054A8.25 8.25 0 0 0 18 4.524l3.11-.732a.75.75 0 0 1 .917.81 47.784 47.784 0 0 0 .005 10.337.75.75 0 0 1-.574.812l-3.114.733a9.75 9.75 0 0 1-6.594-.77l-.108-.054a8.25 8.25 0 0 0-5.69-.625l-2.202.55V21a.75.75 0 0 1-1.5 0V3A.75.75 0 0 1 3 2.25Z",clipRule:"evenodd"}))}const N=s.forwardRef(ee);function oe({session:a,questions:r,answers:i,serverTime:c}){const[b,y]=s.useState(!0),[g,v]=s.useState(!1),[k,F]=s.useState(!1),{currentQuestionIndex:d,setCurrentQuestionIndex:R,answers:o,setAnswers:S,flaggedQuestions:h,toggleFlag:A,violations:E,addViolation:_}=I(),{remainingTime:f,isWarning:L,isDanger:M,formatTime:T}=z(a.end_time,c,a.id);V(a.id,_,a.tryout.max_violations),W(o,a.id),s.useEffect(()=>{const t={};i.forEach(n=>{t[n.question_id]=n.selected_option}),S(t)},[]),s.useEffect(()=>((async()=>{try{await document.documentElement.requestFullscreen()}catch{console.log("Fullscreen request failed")}})(),()=>{document.fullscreenElement&&document.exitFullscreen().catch(()=>{})}),[]),s.useEffect(()=>{f<=0&&!g&&p(!0)},[f]);const l=r[d],m=r.length,j=s.useCallback(t=>{t>=0&&t<m&&R(t)},[m]),B=t=>{S({...o,[l.id]:t})},p=async(t=!1)=>{if(!t&&!k){F(!0);return}v(!0),document.fullscreenElement&&await document.exitFullscreen().catch(()=>{}),Q.post(route("exam.submit",a.id),{},{onFinish:()=>v(!1)})},D=t=>{const n=r[t],x=o[n.id]!==void 0,w=h.includes(n.id);return{isAnswered:x,isFlagged:w,isCurrent:t===d}},u={answered:Object.keys(o).length,flagged:h.length,unanswered:m-Object.keys(o).length};return e.jsxs(e.Fragment,{children:[e.jsx(O,{title:`Ujian - ${a.tryout.title}`}),e.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm border-b sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"font-semibold text-gray-900 truncate max-w-xs",children:a.tryout.title}),e.jsxs("span",{className:"text-sm text-gray-600 hidden sm:inline",children:["Soal ",d+1," dari ",m]})]}),e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-full font-mono text-lg font-bold transition-colors ${M?"bg-red-100 text-red-700 animate-pulse":L?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-700"}`,children:[e.jsx(q,{className:"w-5 h-5"}),T(f)]}),e.jsxs("div",{className:"flex items-center gap-4",children:[E>0&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",title:"Pelanggaran",children:[e.jsx($,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-medium",children:[E,"/",a.tryout.max_violations]})]}),e.jsxs("button",{onClick:()=>p(),disabled:g,className:"btn btn-primary",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Selesai"]})]})]})}),e.jsxs("div",{className:"flex-1 flex",children:[e.jsx("main",{className:"flex-1 p-4 md:p-6 overflow-y-auto",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"card mb-6",children:[e.jsxs("div",{className:"card-header flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l.subcategory&&e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs font-medium text-gray-600",children:l.subcategory.name}),e.jsxs("span",{className:"text-gray-600 text-sm",children:["Soal #",d+1]})]}),e.jsx("button",{onClick:()=>A(l.id),className:`p-2 rounded-lg transition-colors ${h.includes(l.id)?"bg-amber-100 text-amber-600":"hover:bg-gray-100 text-gray-400"}`,title:"Tandai soal",children:h.includes(l.id)?e.jsx(N,{className:"w-5 h-5"}):e.jsx(Y,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"prose prose-lg max-w-none mb-6",dangerouslySetInnerHTML:{__html:l.question_text}}),l.image&&e.jsx("div",{className:"mb-6",children:e.jsx("img",{src:`/storage/${l.image}`,alt:"Gambar soal",className:"max-w-full h-auto rounded-lg border"})}),e.jsx("div",{className:"space-y-3",children:["A","B","C","D","E"].map(t=>{const n=l[`option_${t.toLowerCase()}`];if(!n)return null;const x=o[l.id]===t;return e.jsx("button",{onClick:()=>B(t),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${x?"border-indigo-600 bg-indigo-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium shrink-0 ${x?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600"}`,children:t}),e.jsx("span",{className:"prose prose-sm max-w-none flex-1",dangerouslySetInnerHTML:{__html:n}})]})},t)})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>j(d-1),disabled:d===0,className:"btn btn-secondary",children:[e.jsx(P,{className:"w-5 h-5 mr-1"}),"Sebelumnya"]}),e.jsx("button",{onClick:()=>y(!b),className:"btn btn-secondary sm:hidden",children:"Navigasi"}),e.jsxs("button",{onClick:()=>j(d+1),disabled:d===m-1,className:"btn btn-secondary",children:["Selanjutnya",e.jsx(H,{className:"w-5 h-5 ml-1"})]})]})]})}),e.jsxs("aside",{className:`w-72 bg-white border-l shrink-0 p-4 overflow-y-auto fixed md:relative right-0 top-16 bottom-0 z-30 transition-transform md:translate-x-0 ${b?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[e.jsxs("div",{className:"text-center p-2 bg-emerald-50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-emerald-600",children:u.answered}),e.jsx("p",{className:"text-xs text-emerald-700",children:"Dijawab"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-gray-600",children:u.unanswered}),e.jsx("p",{className:"text-xs text-gray-700",children:"Belum"})]}),e.jsxs("div",{className:"text-center p-2 bg-amber-50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-amber-600",children:u.flagged}),e.jsx("p",{className:"text-xs text-amber-700",children:"Ditandai"})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:r.map((t,n)=>{const{isAnswered:x,isFlagged:w,isCurrent:C}=D(n);return e.jsxs("button",{onClick:()=>j(n),className:`relative aspect-square rounded-lg font-medium text-sm transition-all ${C?"ring-2 ring-indigo-600 ring-offset-2":""} ${x?"bg-emerald-500 text-white hover:bg-emerald-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[n+1,w&&e.jsx(N,{className:"w-3 h-3 text-amber-500 absolute -top-1 -right-1"})]},n)})}),e.jsxs("div",{className:"mt-4 pt-4 border-t text-xs text-gray-600 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded bg-emerald-500"}),e.jsx("span",{children:"Sudah dijawab"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 rounded bg-gray-100"}),e.jsx("span",{children:"Belum dijawab"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:"Ditandai"})]})]})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 md:hidden",onClick:()=>y(!1)})]}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($,{className:"w-8 h-8 text-amber-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Selesaikan Ujian?"}),e.jsx("p",{className:"text-gray-600",children:"Pastikan semua jawaban sudah benar sebelum menyelesaikan ujian."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Total Soal"}),e.jsx("span",{className:"font-semibold",children:m})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-gray-600 flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-emerald-500"}),"Dijawab"]}),e.jsx("span",{className:"font-semibold text-emerald-600",children:u.answered})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-600 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-red-500"}),"Belum Dijawab"]}),e.jsx("span",{className:"font-semibold text-red-600",children:u.unanswered})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>F(!1),className:"btn btn-secondary flex-1",children:"Kembali"}),e.jsx("button",{onClick:()=>p(!0),disabled:g,className:"btn btn-primary flex-1",children:g?"Menyimpan...":"Ya, Selesaikan"})]})]})})]})}export{oe as default};
